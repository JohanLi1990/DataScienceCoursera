---
title: "Stats_Inference_Course_Project"
author: "LI CHENYANG"
date: "December 25, 2015"
output: html_document
---

## 1. Overview
  
In this document, two questions are addressed

- Across the United States, which types of events (as indicated in the EVTYPE variable) are most harmful with respect to population health?

- Across the United States, which types of events have the greatest economic consequences?
  
## 2. Simulations: Include English explanations of the simulations you ran, with the accompanying R code. Your explanations should make clear what the R code accomplishes.
  
(Majority of the codes referred from Prof Brian Caffo's lecture notes. Therefore all credit goes to him. )
  
The goal is to demonstrate *Central Limit Therom* with random variables generated by exponential distribution
  
    
- First, create a group of 40 random variables x 1000 random variable, with each row represent one observation of the 40 variables. 
  
```{r}
nosim <-  1000
All_observ <- matrix(rexp(40000, rate = 0.2), nosim)
```
  
- Next creat a function to calculate and normalize all the means from one row of observation
  
```{r}
cfunc <- function(x, n) sqrt(n) * (mean(x) - 5) / 5 

```
  
- Next create a dataframe by applying function over each row in the All_observ matrix
  
```{r}
n_size = 40
final_form <- data.frame(samples = apply(X = All_observ, MARGIN = 1, FUN = cfunc, n_size))
```
   
  
## 3. Sample Mean versus Theoretical Mean: Include figures with titles. In the figures, highlight the means you are comparing. Include text that explains the figures and what is shown on them, and provides appropriate numbers.
   
- According to central limit therom, the theoretical mean for the distribution of sample mean, after proper normalization, should be 0. 
- Similarly, the theoretical variance after normalization, should be 1. 
- Below is the plot of the distribution of mean of 40 exponential variable. 
   
```{r, echo=FALSE, fig.height=3.5, fig.width=10}
library(ggplot2)
g <- ggplot(final_form, aes(x = samples)) + geom_histogram(alpha = .20, binwidth=.2, colour = "black", aes(y = ..density..)) 
#g <- g + geom_vline(aes(xintercept = 0, colour = "mycolor1", size = 1.0))
g<- g + geom_vline(xintercept = mean(final_form$samples), colour = "blue", size = 0.6)
g<- g + geom_vline(xintercept = 0, colour = "red", size = 0.6, type = "dot")
g + ggtitle("Distribution of sample mean")
   
```
   
- From the graph, there are two thin lines (my apology it is hard to see, I do not want the lines to overlap).
  
  
- One line is red and the other is blue. The red line represents theoretic mean which is 0, and the blue line represent sample mean for the distribution. We can calculate the sample mean and find out that it is in fact

```{r}
mean(final_form$samples)
```
which is fairly close to the theoretic mean. 
  

- By observation, we can see that the sample distribution is centered comfortably around the population mean. 


- Next, we look at sample variance to further validate central limit theorem. 

  
## 4. Sample Variance versus Theoretical Variance: Include figures (output from R) with titles. Highlight the variances you are comparing. Include text that explains your understanding of the differences of the variances.

- Variability of the graph will affect the width of the graph. 
- The higher the variance, the narrower the graph will be. 
- Therefore, we can draw in this case a standard normal distribution and try to compare the width with that of the sample distribution

```{r, echo=FALSE, fig.height=3.5, fig.width=10}

g <- ggplot(final_form, aes(x = samples)) + geom_histogram(alpha = .20, binwidth=.3, colour = "black", aes(y = ..density..)) 
g <- g + stat_function(fun = dnorm, size = 1.5) + ggtitle("sample distribution & standard normal distribution")
g

```

- The black curve represent standard normal distribution. 
- As we can see there is almost no difference in width between these two distributions. 
- To further prove the point, we calculat the sample variance. 

```{r}
var(final_form$samples)

```

- the sample variance is very very close to 1. 
- Therefore we can safely conclude that in this case, Central Limit Theorem is validated. 


## 5. Distribution: Via figures and text, explain how one can tell the distribution is approximately normal.

- We can simply tell that the distribution is roughly normal, just by looking at the plot below 

```{r, echo=FALSE, fig.height=3.5, fig.width=10}

g <- ggplot(final_form, aes(x = samples)) + geom_histogram(alpha = .20, binwidth=.3, colour = "black", aes(y = ..density..)) 
g <- g + stat_function(fun = dnorm, size = 1.5)
g

```

- To show how different it would be if it is just random expontial distribution samples, without taking averages. We construct the following plot:

```{r, echo=FALSE, fig.height=3.5, fig.width=10}

hist(rexp(1000))

```

- We can tell by the graph above that the plot is no way gaussian. 


